version: 0.2

eb_codebuild_settings:
  CodeBuildServiceRole: ${CodeBuildServiceRole}
  ComputeType: BUILD_GENERAL1_SMALL
  Image: aws/codebuild/standard:2.0

phases:
  install:
    runtime-versions:
      python: 3.7
  pre_build:
    commands:
      # Install the dependancies:
      - pip install -r ./requirements.txt
      # Run the full suite:
      - python run_pytest_suites.py -sx --api ${API_URL} --dont-run-file known_failures_test_api --dont-run-file known_bugs
      - pytest -sx test_mainManager.py --api ${API_URL} --dont-run-file known_failures_test_api --dont-run-file known_bugs
      - echo -e "\n  --- End of Running suites. All tests pass.\n"
